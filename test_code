import codeforces_api
import pandas as pd

parser = codeforces_api.CodeforcesParser()
cf_api = codeforces_api.CodeforcesApi('2e89464a5fb953bf014b7c72036cc90366d97905','e9652017350294cdeda8690b20bf56d6d8fe3360')

test = cf_api.problemset_recent_status(1000, problemset_name= "")
id_list=[]
tags_list=[]
user_list=[]
problemrating_list=[]
user_rating_list = []
problemindex_list = []
for i in test:
    ta = i.problem.tags
    check = i.author.members
    # print(i.id,':')
    id_list.append(i.id)
    problemrating_list.append(i.problem.rating)
    tags_list.append(ta)
    for j in check:
        # print(j.handle)
        user_list.append(j.handle)
    # print(ta)
# writer.writerow(ta)
a = ({'Submission_Id':id_list,'User_Name' :user_list,'Tags':tags_list,'Problem_Rating':problemrating_list})
df = pd.DataFrame.from_dict(a, orient='index')
df = df.transpose()
compression_opts = dict(method='zip',
                        archive_name='ProbRecco.csv')  
df.to_csv('IEProject.zip', index=False,
          compression=compression_opts) 
  
